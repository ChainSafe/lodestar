
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Lodestar documentation - Typescript Eth2.0 client" name="description"/>
<link href="https://chainsafe.github.io/lodestar/packages/beacon-state-transition/interfaces/allforks_util.iepochprocess/" rel="canonical"/>
<link href="../../../../assets/round-icon.ico" rel="icon"/>
<meta content="mkdocs-1.2.3, mkdocs-material-8.1.3" name="generator"/>
<title>Allforks util.iepochprocess - Lodestar documentation</title>
<link href="../../../../assets/stylesheets/main.edf004c2.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.e6a45f82.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../../stylesheets/extras.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="deep-purple" data-md-color-primary="black" data-md-color-scheme="preference" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#interface-iepochprocess">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Lodestar documentation" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Lodestar documentation">
<img alt="logo" src="../../../../assets/lodestar_icon_300.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Lodestar documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Allforks util.iepochprocess
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="black" data-md-color-scheme="preference" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/chainsafe/lodestar/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    chainsafe/lodestar
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Lodestar documentation" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Lodestar documentation">
<img alt="logo" src="../../../../assets/lodestar_icon_300.png"/>
</a>
    Lodestar documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/chainsafe/lodestar/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    chainsafe/lodestar
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
        Getting started
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../installation/">
        Installation
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          CLI Usage
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="CLI Usage" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          CLI Usage
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/testnet/">
        Mainnet or public testnet
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/local/">
        Local testnet
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/key-management/">
        Key management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/prometheus-grafana/">
        Prometheus &amp; Grafana Setup
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Reference
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../reference/cli/">
        Command line
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../libraries/">
        Libraries
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          Design
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Design" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Design
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../design/architecture/">
        Beacon node architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../design/depgraph/">
        Lodestar package structure
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contributing/">
        Contributing
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#hierarchy">
    Hierarchy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#index">
    Index
  </a>
<nav aria-label="Index" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#properties">
    Properties
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#properties_1">
    Properties
  </a>
<nav aria-label="Properties" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#optional-balances">
    Optional balances
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#baserewardperincrement">
    baseRewardPerIncrement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#currepochunslashedtargetstakebyincrement">
    currEpochUnslashedTargetStakeByIncrement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#currentepoch">
    currentEpoch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indiceseligibleforactivation">
    indicesEligibleForActivation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indiceseligibleforactivationqueue">
    indicesEligibleForActivationQueue
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indicestoeject">
    indicesToEject
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indicestoslash">
    indicesToSlash
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#isactivenextepoch">
    isActiveNextEpoch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nextepochshufflingactivevalidatorindices">
    nextEpochShufflingActiveValidatorIndices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nextepochtotalactivebalancebyincrement">
    nextEpochTotalActiveBalanceByIncrement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prevepoch">
    prevEpoch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prevepochunslashedstake">
    prevEpochUnslashedStake
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statuses">
    statuses
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#totalactivestakebyincrement">
    totalActiveStakeByIncrement
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/chainsafe/lodestar/edit/master/docs/packages/beacon-state-transition/interfaces/allforks_util.iepochprocess.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<p><a href="../../">@chainsafe/lodestar-beacon-state-transition</a> › <a href="../../globals/">Globals</a> › <a href="../../modules/allforks_util/">allForks/util</a> › <a href="./">IEpochProcess</a></p>
<h1 id="interface-iepochprocess">Interface: IEpochProcess<a class="headerlink" href="#interface-iepochprocess" title="Permanent link">¶</a></h1>
<p>Pre-computed disposable data to process epoch transitions faster at the cost of more memory.</p>
<p>The AttesterStatus (and FlatValidator under status.validator) objects and
EpochStakeSummary are tracked in the IEpochProcess and made available as additional context in the
epoch transition.</p>
<h2 id="hierarchy">Hierarchy<a class="headerlink" href="#hierarchy" title="Permanent link">¶</a></h2>
<ul>
<li><strong>IEpochProcess</strong></li>
</ul>
<h2 id="index">Index<a class="headerlink" href="#index" title="Permanent link">¶</a></h2>
<h3 id="properties">Properties<a class="headerlink" href="#properties" title="Permanent link">¶</a></h3>
<ul>
<li><a href="./#optional-balances">balances</a></li>
<li><a href="./#baserewardperincrement">baseRewardPerIncrement</a></li>
<li><a href="./#currepochunslashedtargetstakebyincrement">currEpochUnslashedTargetStakeByIncrement</a></li>
<li><a href="./#currentepoch">currentEpoch</a></li>
<li><a href="./#indiceseligibleforactivation">indicesEligibleForActivation</a></li>
<li><a href="./#indiceseligibleforactivationqueue">indicesEligibleForActivationQueue</a></li>
<li><a href="./#indicestoeject">indicesToEject</a></li>
<li><a href="./#indicestoslash">indicesToSlash</a></li>
<li><a href="./#isactivenextepoch">isActiveNextEpoch</a></li>
<li><a href="./#nextepochshufflingactivevalidatorindices">nextEpochShufflingActiveValidatorIndices</a></li>
<li><a href="./#nextepochtotalactivebalancebyincrement">nextEpochTotalActiveBalanceByIncrement</a></li>
<li><a href="./#prevepoch">prevEpoch</a></li>
<li><a href="./#prevepochunslashedstake">prevEpochUnslashedStake</a></li>
<li><a href="./#statuses">statuses</a></li>
<li><a href="./#totalactivestakebyincrement">totalActiveStakeByIncrement</a></li>
</ul>
<h2 id="properties_1">Properties<a class="headerlink" href="#properties_1" title="Permanent link">¶</a></h2>
<h3 id="optional-balances"><code>Optional</code> balances<a class="headerlink" href="#optional-balances" title="Permanent link">¶</a></h3>
<p>• <strong>balances</strong>? : <em>number[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L104">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:104</a></em></p>
<hr/>
<h3 id="baserewardperincrement">baseRewardPerIncrement<a class="headerlink" href="#baserewardperincrement" title="Permanent link">¶</a></h3>
<p>• <strong>baseRewardPerIncrement</strong>: <em>number</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L46">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:46</a></em></p>
<p>For altair</p>
<hr/>
<h3 id="currepochunslashedtargetstakebyincrement">currEpochUnslashedTargetStakeByIncrement<a class="headerlink" href="#currepochunslashedtargetstakebyincrement" title="Permanent link">¶</a></h3>
<p>• <strong>currEpochUnslashedTargetStakeByIncrement</strong>: <em>number</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L48">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:48</a></em></p>
<hr/>
<h3 id="currentepoch">currentEpoch<a class="headerlink" href="#currentepoch" title="Permanent link">¶</a></h3>
<p>• <strong>currentEpoch</strong>: <em>Epoch</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L40">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:40</a></em></p>
<hr/>
<h3 id="indiceseligibleforactivation">indicesEligibleForActivation<a class="headerlink" href="#indiceseligibleforactivation" title="Permanent link">¶</a></h3>
<p>• <strong>indicesEligibleForActivation</strong>: <em>ValidatorIndex[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L92">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:92</a></em></p>
<p>Indices of validators that may become active once churn and finaly allow.
<div class="highlight"><pre><span></span><code>v.activationEpoch === FAR_FUTURE_EPOCH &amp;&amp; v.activationEligibilityEpoch &lt;= currentEpoch
</code></pre></div>
Many validators could be on indicesEligibleForActivation, but only up to churnLimit will be activated.
For less than 327680 validators, churnLimit = 4 (minimum possible), so max processed is 4.</p>
<hr/>
<h3 id="indiceseligibleforactivationqueue">indicesEligibleForActivationQueue<a class="headerlink" href="#indiceseligibleforactivationqueue" title="Permanent link">¶</a></h3>
<p>• <strong>indicesEligibleForActivationQueue</strong>: <em>ValidatorIndex[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L83">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:83</a></em></p>
<p>Indices of validators that just joinned and will be eligible for the active queue.
<div class="highlight"><pre><span></span><code>v.activationEligibilityEpoch === FAR_FUTURE_EPOCH &amp;&amp; v.effectiveBalance === MAX_EFFECTIVE_BALANCE
</code></pre></div>
All validators in indicesEligibleForActivationQueue get activationEligibilityEpoch set. So it can only include
validators that have just joinned the registry through a valid full deposit(s).
<div class="highlight"><pre><span></span><code>max indicesEligibleForActivationQueue = SLOTS_PER_EPOCH * MAX_DEPOSITS
</code></pre></div>
For mainnet spec = 512</p>
<hr/>
<h3 id="indicestoeject">indicesToEject<a class="headerlink" href="#indicestoeject" title="Permanent link">¶</a></h3>
<p>• <strong>indicesToEject</strong>: <em>ValidatorIndex[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L101">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:101</a></em></p>
<p>Indices of validators that will be ejected due to low balance.
<div class="highlight"><pre><span></span><code>status.active &amp;&amp; v.exitEpoch === FAR_FUTURE_EPOCH &amp;&amp; v.effectiveBalance &lt;= config.EJECTION_BALANCE
</code></pre></div>
Potentially the entire validator set could be added to indicesToEject, and all validators in the array will have
their validator object mutated. Exit queue churn delays exit, but the object is mutated immediately.</p>
<hr/>
<h3 id="indicestoslash">indicesToSlash<a class="headerlink" href="#indicestoslash" title="Permanent link">¶</a></h3>
<p>• <strong>indicesToSlash</strong>: <em>ValidatorIndex[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L70">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:70</a></em></p>
<p>Indices which will receive the slashing penalty
<div class="highlight"><pre><span></span><code>v.withdrawableEpoch === currentEpoch + EPOCHS_PER_SLASHINGS_VECTOR / 2
</code></pre></div>
There's a practical limitation in number of possible validators slashed by epoch, which would share the same
withdrawableEpoch. Note that after some count exitChurn would advance the withdrawableEpoch.
<div class="highlight"><pre><span></span><code>maxSlashedPerSlot = SLOTS_PER_EPOCH * (MAX_PROPOSER_SLASHINGS + MAX_ATTESTER_SLASHINGS * bits)
</code></pre></div>
For current mainnet conditions (bits = 128) that's <code>maxSlashedPerSlot = 8704</code>.
For less than 327680 validators, churnLimit = 4 (minimum possible)
For exitChurn to overtake the slashing delay, there should be
<div class="highlight"><pre><span></span><code>churnLimit * (EPOCHS_PER_SLASHINGS_VECTOR / 2 - 1 - MAX_SEED_LOOKAHEAD)
</code></pre></div>
For mainnet conditions that's 16364 validators. So the limiting factor is the max operations on the block. Note
that on average indicesToSlash must contain churnLimit validators (4), but it can spike to a max of 8704 in a
single epoch if there haven't been exits in a while and there's a massive attester slashing at once of validators
that happen to be in the same committee, which is very unlikely.</p>
<hr/>
<h3 id="isactivenextepoch">isActiveNextEpoch<a class="headerlink" href="#isactivenextepoch" title="Permanent link">¶</a></h3>
<p>• <strong>isActiveNextEpoch</strong>: <em>boolean[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L132">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:132</a></em></p>
<p>Track by validator index if it's active in the next epoch.
Used in <code>processEffectiveBalanceUpdates</code> to save one loop over validators after epoch process.</p>
<hr/>
<h3 id="nextepochshufflingactivevalidatorindices">nextEpochShufflingActiveValidatorIndices<a class="headerlink" href="#nextepochshufflingactivevalidatorindices" title="Permanent link">¶</a></h3>
<p>• <strong>nextEpochShufflingActiveValidatorIndices</strong>: <em>ValidatorIndex[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L114">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:114</a></em></p>
<p>Active validator indices for currentEpoch + 2.
This is only used in <code>afterProcessEpoch</code> to compute epoch shuffling, it's not efficient to calculate it at that time
since it requires 1 loop through validator.
| epoch process fn                 | nextEpochTotalActiveBalance action |
| -------------------------------- | ---------------------------------- |
| beforeProcessEpoch               | calculate during the validator loop|
| afterEpochProcess                | read it                            |</p>
<hr/>
<h3 id="nextepochtotalactivebalancebyincrement">nextEpochTotalActiveBalanceByIncrement<a class="headerlink" href="#nextepochtotalactivebalancebyincrement" title="Permanent link">¶</a></h3>
<p>• <strong>nextEpochTotalActiveBalanceByIncrement</strong>: <em>number</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L126">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:126</a></em></p>
<p>Altair specific, this is total active balances for the next epoch.
This is only used in <code>afterProcessEpoch</code> to compute base reward and sync participant reward.
It's not efficient to calculate it at that time since it requires looping through all active validators,
so we should calculate it during <code>processEffectiveBalancesUpdate</code> which gives us updated effective balance.
| epoch process fn                 | nextEpochTotalActiveBalance action |
| -------------------------------- | ---------------------------------- |
| beforeProcessEpoch               | initialize as BigInt(0)            |
| processEffectiveBalancesUpdate   | calculate during the loop          |
| afterEpochProcess                | read it                            |</p>
<hr/>
<h3 id="prevepoch">prevEpoch<a class="headerlink" href="#prevepoch" title="Permanent link">¶</a></h3>
<p>• <strong>prevEpoch</strong>: <em>Epoch</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L39">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:39</a></em></p>
<hr/>
<h3 id="prevepochunslashedstake">prevEpochUnslashedStake<a class="headerlink" href="#prevepochunslashedstake" title="Permanent link">¶</a></h3>
<p>• <strong>prevEpochUnslashedStake</strong>: <em><a href="../allforks_util.iepochstakesummary/">IEpochStakeSummary</a></em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L47">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:47</a></em></p>
<hr/>
<h3 id="statuses">statuses<a class="headerlink" href="#statuses" title="Permanent link">¶</a></h3>
<p>• <strong>statuses</strong>: <em><a href="../allforks_util.iattesterstatus/">IAttesterStatus</a>[]</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L103">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:103</a></em></p>
<hr/>
<h3 id="totalactivestakebyincrement">totalActiveStakeByIncrement<a class="headerlink" href="#totalactivestakebyincrement" title="Permanent link">¶</a></h3>
<p>• <strong>totalActiveStakeByIncrement</strong>: <em>number</em></p>
<p><em>Defined in <a href="https://github.com/ChainSafe/lodestar/blob/eff7b9f/packages/beacon-state-transition/src/allForks/util/epochProcess.ts#L44">packages/beacon-state-transition/src/allForks/util/epochProcess.ts:44</a></em></p>
<p>This is sum of active validators' balance in eth.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/ChainSafe/lodestar" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-social__link" href="https://twitter.com/ChainSafe" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-social__link" href="https://discord.gg/yjyvFRP" rel="noopener" target="_blank" title="discord.gg">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241z"></path></svg>
</a>
<a class="md-social__link" href="https://medium.com/ChainSafe" rel="noopener" target="_blank" title="medium.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 32v448h448V32H0zm372.2 106.1-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
<script src="../../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
</body>
</html>