language: node_js
node_js:
  - "lts/*"

cache:
  yarn: true
  directories:
    - node_modules

jobs:
  include:
    - stage: Lint and Check types
    - name: Lodestar
      script: yarn run check-types & yarn run lint
    - name: Eth2.0 Types
      script: yarn run


    - stage: Unit Tests
      name: Lodestar
      script: yarn run test:unit && yarn run codecov
    - name: Eth2.0 Types
      script: yarn run

    - stage: e2e Tests
      name: Lodestar
      script: yarn run test:e2e
    - name: Eth2.0 Types
      script: yarn run

    - stage: Spec Tests
    - name: Lodestar
      script: yarn run test:spec
    - name: Eth2.0 Types
      script: yarn run

before_deploy: yarn run build:docs

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GH_PAGES_TOKEN
  keep_history: true
  local_dir: docs
  on:
    branch: master
